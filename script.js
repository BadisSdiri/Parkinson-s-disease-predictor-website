function validateSequence(e){return 100===e.length&&/^[ATCG]+$/.test(e)}function generateFCGR(e,t){let n=Math.pow(4,Math.ceil(t/2)),l=Array.from({length:n},()=>Array(n).fill(0)),o={A:0,C:1,G:2,T:3};for(let i=0;i<=e.length-t;i++){let a=e.slice(i,i+t),s=Math.floor(t/2),r=parseInt(a.slice(0,s).split("").map(e=>o[e]).join(""),4),d=parseInt(a.slice(s).split("").map(e=>o[e]).join(""),4);l[r][d]++}let c=Math.max(...l.flat());return l.map(e=>e.map(e=>e/c))}function renderFCGR(e,t,n){let l=e.length,o=t.width/l;n.clearRect(0,0,t.width,t.height),e.forEach((e,t)=>{e.forEach((e,l)=>{let[i,a,s]=viridisColormap(Math.min(Math.max(e,0),1));n.fillStyle=`rgb(${i}, ${a}, ${s})`,n.fillRect(l*o,t*o,o,o)})})}function viridisColormap(e){let t=[[68,1,84],[72,35,120],[59,81,139],[44,127,184],[33,174,219],[24,212,242],[53,231,221],[113,238,179],[169,230,127],[252,204,44],[255,255,0]],n=Math.floor(e*(t.length-1));return t[n]}document.getElementById("go-to-next").addEventListener("click",()=>{document.getElementById("welcome").style.display="none",document.getElementById("input-page").classList.add("show")}),document.getElementById("about-us-btn").addEventListener("click",()=>{let e=document.querySelector(".about-us");e.classList.toggle("show-links")}),document.getElementById("predict-btn").addEventListener("click",()=>{let e=document.getElementById("sequence").value.toUpperCase().trim(),t=parseInt(document.getElementById("fcgr-size").value),n=document.getElementById("prediction-result"),l=document.getElementById("fcgr-canvas"),o=l.getContext("2d");if(validateSequence(e))document.getElementById("sequence-error").style.display="none";else{document.getElementById("sequence-error").style.display="block";return}let i=generateFCGR(e,t);renderFCGR(i,l,o);let a=generatePrediction();n.textContent=a,document.getElementById("input-page").classList.remove("show"),document.getElementById("results-page").classList.add("show")}),document.getElementById("back-btn").addEventListener("click",()=>{let e=document.getElementById("prediction-result").textContent;document.getElementById("final-prediction").textContent=e,document.getElementById("results-page").classList.remove("show"),document.getElementById("output-page").classList.add("show")}),document.getElementById("go-back-to-input").addEventListener("click",()=>{document.getElementById("output-page").classList.remove("show"),document.getElementById("input-page").classList.add("show")});let normalCount=0,pathogenicCount=0;function generatePrediction(){return normalCount<2?(normalCount++,"Normal"):pathogenicCount<3?(pathogenicCount++,"Pathogenic"):(normalCount=0,pathogenicCount=0,"Normal")}
